# 五金CRM系统用户手册

## 1. 系统简介

本系统是一个为五金店和工程项目管理设计的客户关系管理（CRM）系统。它提供了产品管理、库存控制、销售开单、客户管理、工程项目跟踪以及报表统计等功能，旨在帮助您更高效地管理业务。

**主要功能：**

*   **仪表盘**：展示关键业务指标和系统概览。
*   **产品管理**：管理五金类产品信息、分类和库存。
*   **库存管理**：记录产品入库、出库，提供库存预警。
*   **销售管理**：创建和管理销售订单，支持现金和扫码美金支付。
*   **客户管理**：维护客户信息和购买历史。
*   **工程项目管理**：跟踪项目进度、材料使用和成本。
*   **报表统计**：生成销售、库存、客户和项目报表，支持Excel导出。
*   **用户管理**：管理员工账户和权限（仅限管理员）。
*   **多语言支持**：支持中文和英文界面切换。

## 2. 系统安装与启动（本地运行）

### 2.1 环境要求

*   操作系统：Windows, macOS, 或 Linux
*   Python 3.6 或更高版本
*   pip (Python 包管理器)

### 2.2 安装步骤

1.  **解压软件包**：将收到的 `crm_system.zip` 文件解压到您希望存放系统的文件夹中。
2.  **打开终端/命令提示符**：
    *   Windows: 按 `Win + R`，输入 `cmd` 并回车。
    *   macOS: 打开“应用程序” -> “实用工具” -> “终端”。
    *   Linux: 通常可以通过 `Ctrl + Alt + T` 打开终端。
3.  **进入系统目录**：使用 `cd` 命令进入您解压 `crm_system` 的文件夹。例如：
    ```bash
    cd path/to/crm_system
    ```
    (请将 `path/to/crm_system` 替换为实际路径)
4.  **安装依赖**：在终端中运行以下命令安装系统所需的库：
    ```bash
    pip install -r requirements.txt
    ```
    如果您的系统同时安装了 Python 2 和 Python 3，可能需要使用 `pip3`：
    ```bash
    pip3 install -r requirements.txt
    ```

### 2.3 启动系统

1.  **运行启动脚本**：在终端中，确保您仍在 `crm_system` 目录下，然后运行：
    *   Linux/macOS:
        ```bash
        chmod +x run.sh
        ./run.sh
        ```
    *   Windows:
        ```bash
        python app.py
        ```
2.  **访问系统**：启动成功后，终端会显示类似以下信息：
    ```
     * Running on http://127.0.0.1:5000
    ```
    打开您的网页浏览器（如 Chrome, Firefox, Edge），在地址栏输入 `http://127.0.0.1:5000` 或 `http://localhost:5000`，然后按回车键即可访问系统。

### 2.4 首次登录

*   默认管理员用户名：`admin`
*   默认管理员密码：`admin123`

请在首次登录后，通过“用户管理”功能修改默认密码。

### 2.5 停止系统

在运行启动命令的终端窗口中，按 `Ctrl + C` 即可停止系统服务。

## 3. 功能模块详解

### 3.1 仪表盘

登录后首先进入仪表盘页面，这里汇总了关键业务数据：

*   **统计卡片**：快速了解产品总数、客户总数、销售订单数和项目总数。
*   **库存预警**：列出当前库存量低于或等于设定的最低库存量的产品。
*   **最近销售**：显示最近创建的5个销售订单及其状态。
*   **进行中的项目**：展示当前状态为“进行中”的项目及其进度。

### 3.2 产品管理

*   **产品列表**：查看所有产品信息，可通过搜索框快速查找。点击“编辑”修改产品信息，点击“删除”移除产品（若产品未关联销售或项目）。
*   **添加产品**：点击“添加产品”按钮，填写产品编码、名称、分类、规格、单位、采购价、销售价、最低库存量和描述等信息。产品编码必须唯一。
*   **产品分类**：(当前版本需在代码中或直接操作数据库添加/修改分类，后续可开发界面管理功能)

### 3.3 库存管理

*   **库存列表**：显示所有产品的当前库存数量。库存数量会根据入库、出库、销售和项目领料自动更新。
*   **入库**：点击“入库”按钮，选择产品，输入入库数量和备注，通常用于采购到货。
*   **出库**：点击“出库”按钮，选择产品，输入出库数量、来源类型（如：调整、领用等）和备注。销售和项目领料会自动进行出库操作，无需在此手动操作。
*   **库存记录**：查看所有的入库和出库历史记录，包括操作类型、数量、来源、操作员和时间。

### 3.4 销售管理

*   **销售列表**：展示所有销售订单，包括订单号、客户、日期、金额、支付状态等。可进行搜索。
*   **添加销售**：
    1.  点击“添加销售”按钮。
    2.  选择客户，选择支付方式（现金/扫码美金），填写备注。
    3.  点击“提交”创建订单框架，系统将跳转到订单编辑页面。
*   **编辑销售/添加商品**：
    1.  在订单编辑页面，选择要销售的产品，输入数量。
    2.  系统会自动带出单价并计算金额。
    3.  点击“添加商品”按钮将商品加入订单列表。
    4.  可重复添加多个商品。
    5.  在下方可以输入订单折扣金额，系统会自动计算实际应付金额。
    6.  选择支付状态。
    7.  填写备注。
    8.  点击“更新订单”保存整个订单信息。
*   **查看销售**：点击订单号或“查看”按钮，可以查看订单详情，并提供打印功能。
*   **删除销售**：在列表页点击“删除”按钮可删除订单。删除订单会自动恢复对应商品的库存。
*   **删除订单项**：在编辑销售页面，可以删除已添加的某个商品。删除商品会自动恢复库存。

### 3.5 客户管理

*   **客户列表**：查看所有客户信息，支持搜索。
*   **添加客户**：点击“添加客户”按钮，填写客户名称、联系人、电话、邮箱、地址、客户类型和备注。
*   **编辑客户**：点击“编辑”按钮修改客户信息。
*   **删除客户**：点击“删除”按钮移除客户（若客户未关联销售或项目）。

### 3.6 工程项目管理

*   **项目列表**：展示所有工程项目，包括项目名称、客户、起止日期、状态、预算、成本和项目经理。
*   **添加项目**：点击“添加项目”按钮，填写项目名称、选择客户、设定起止日期、预算、选择项目经理和填写项目描述。
*   **编辑项目/添加材料**：
    1.  在项目编辑页面，可以修改项目的基本信息。
    2.  在“材料”部分，选择项目所需的产品，输入计划数量、单价（通常是采购价或成本价）和备注。
    3.  点击“添加材料”按钮。
    4.  添加的材料会影响项目的“实际成本”。
*   **查看项目**：点击项目名称或“查看”按钮，可以查看项目详情，包括基本信息和材料清单。
*   **删除项目**：在列表页点击“删除”按钮可删除项目。
*   **删除材料**：在编辑项目页面，可以删除已添加的某个材料。删除材料会更新项目成本。

### 3.7 报表统计

*   **报表中心**：提供各类报表的入口。
*   **销售报表**：选择日期范围，生成该时间段内的销售统计，包括总销售额、订单数、按支付方式统计、按客户统计等。支持导出Excel。
*   **库存报表**：显示当前所有产品的库存状态、总价值、按分类统计和库存预警列表。支持导出Excel。
*   **客户报表**：展示客户列表、按类型统计和每个客户的订单数量及消费总额。支持导出Excel。
*   **项目报表**：显示所有项目列表、总预算、总成本以及按状态统计。支持导出Excel。
*   **导出Excel**：在各个报表页面，点击“导出到Excel”按钮，即可下载对应报表的Excel文件。

### 3.8 用户管理（仅限管理员）

*   **用户列表**：查看系统中的所有用户及其角色和状态。
*   **添加用户**：创建新的员工账户，设置用户名、姓名、联系方式、初始密码和分配角色。
*   **编辑用户**：修改用户信息、重置密码、更改角色或启用/禁用账户。
*   **删除用户**：删除员工账户（不能删除自己，不能删除有关联业务的用户）。
*   **角色列表**：查看系统预设的角色。
*   **添加/编辑角色**：(当前版本角色和权限较为固定，如需修改建议联系开发人员)

### 3.9 语言切换

在页面右上角，点击带有国旗图标的语言切换按钮，可以选择“中文”或“English”来切换界面语言。

## 4. 常见问题与维护

*   **无法访问系统**：
    *   请确保已按照“启动系统”步骤正确运行了 `app.py` 或 `./run.sh`。
    *   检查终端是否有报错信息。
    *   确认浏览器地址是否为 `http://127.0.0.1:5000`。
    *   检查防火墙设置是否阻止了端口5000的访问。
*   **忘记密码**：目前没有自助找回密码功能。如果忘记密码，需要联系有数据库访问权限的人员直接修改数据库中的 `user` 表。
*   **数据备份**：系统数据存储在 `crm_system/database/crm.db` 文件中。请定期手动备份此文件以防数据丢失。
*   **系统更新**：如果收到更新包，通常只需替换旧的文件，然后重新执行“安装依赖”和“启动系统”步骤即可。

## 5. 技术支持

如果您在使用过程中遇到任何问题或需要进一步的帮助，请联系系统提供方。

